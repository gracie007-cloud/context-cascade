# Context Cascade OpenCode Adapter\n\nThis adapter exposes the existing Context Cascade markdown prompts to an OpenCode-style host without modifying the Claude plugin system. It registers slash commands derived from files under `commands/` and optionally injects skills sourced from `skills/**/SKILL.md`.\n\n## Features\n- Registers one OpenCode command per markdown file in `commands/`, plus aliases when the filename matches its parent directory.\n- Optional skill injection: keyword-based matching across skill names/descriptions and insertion of the skill body into system context.\n- Host-agnostic API: expects a minimal `OpenCodeHost` interface and can be wired into other runtimes.\n- Dev harness to try the plugin without installing OpenCode.\n\n## Project Layout\n```\nopencode-plugin/\n  package.json\n  tsconfig.json\n  src/\n    index.ts         # Plugin entry; registers commands and optional skill injection\n    loader.ts        # Discovers commands/skills from repo content\n    markdown.ts      # Markdown parsing helpers\n    registry.ts      # Host interfaces and options\n    skill_index.ts   # Keyword-based skill matcher\n  scripts/\n    dev-simulate.mjs # Local harness to list/run/match without OpenCode\n```\n\n## Installation\n```bash\ncd opencode-plugin\nnpm install\n```\n\n## Building\n```bash\nnpm run build\n```\nOutputs compiled code to `dist/`.\n\n## Dev Harness\nAfter building, you can simulate plugin usage without OpenCode:\n```bash\nnpm run dev -- list\nnpm run dev -- run cc:quality:review-pr \"review the latest PR\"\nnpm run dev -- match \"need swarm coordination for github repo\"\n```\n\nThe harness prints registered commands, expanded prompts, or injected skill content depending on the mode.\n\n## Command Naming Rules\n- Base name: path under `commands/` joined with `:` plus the filename (without extension), prefixed by `/cc:`. Example: `commands/quality/review-pr.md` → `/cc:quality:review-pr`.\n- Alias: if the filename matches its parent folder, an alias drops the duplicate. Example: `commands/delivery/sparc/sparc.md` → `/cc:delivery:sparc` (alias) and `/cc:delivery:sparc:sparc` (full).\n\n## Skill Injection\n- Disabled by default; enable via `CC_ENABLE_SKILLS=1` or `enableSkillInjection: true` when initializing the plugin.\n- Matching is keyword-based (name/description/body) with a simple scoring heuristic; returns the top few skills.\n- Injected context uses the format:\n  ```\n  [Context Cascade Skill Injected: <skill-name>]\n  <skill body markdown>\n  ```\n\n## Configuration\nEnvironment variables (or `PluginOptions`):\n- `CONTEXT_CASCADE_ROOT` – path to the repo root containing `commands/` and `skills/` (defaults to parent of plugin dir).\n- `CC_COMMAND_PREFIX` – prefix added to all registered commands (default `cc`).\n- `CC_ENABLE_SKILLS` – set to `1` to enable skill injection.\n- `CC_COMMAND_PREFIX` – optional override for the command prefix.\n- `skillMatchCount` and `skillMatchThreshold` (options) adjust matching behavior.\n\n## Assumptions\n- Source of truth for prompts remains the markdown files in this repository; the adapter never edits them.\n- Host provides `registerCommand` and optionally `onUserMessage`/`addSystemContext` for skill injection. A fallback `/inject` command is registered if the host lacks message hooks.\n*** End Patch
